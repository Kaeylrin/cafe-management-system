<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Sign Up – Cafe Nowa</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet"/>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --cream:   #c8b89a;
      --dark:    #1a1109;
      --card-bg: #ffffff;
      --accent:  #1a1109;
      --muted:   #6b5c4c;
      --input-bg:#f5f0eb;
      --border:  #ddd5c8;
      --error:   #c0392b;
      --success: #27ae60;
    }

    body {
      min-height: 100vh;
      background-color: var(--cream);
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'DM Sans', sans-serif;
      padding: 24px 16px;
    }

    /* card */
    .card {
      display: flex;
      width: 100%;
      max-width: 900px;
      border-radius: 20px;
      overflow: hidden;
      box-shadow: 0 24px 64px rgba(26,17,9,.22);
    }

    /* left panel */
    .panel-left {
      flex: 0 0 340px;
      background: var(--dark);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 48px 32px;
      gap: 24px;
      position: relative;
      overflow: hidden;
    }

    .panel-left::before {
      content:'';
      position: absolute;
      width: 320px; height: 320px;
      border-radius: 50%;
      background: rgba(200,184,154,.07);
      bottom: -100px; right: -80px;
    }
    .panel-left::after {
      content:'';
      position: absolute;
      width: 180px; height: 180px;
      border-radius: 50%;
      background: rgba(200,184,154,.06);
      top: -60px; left: -40px;
    }

    .coffee-icon {
      width: 140px; height: 140px;
      position: relative; z-index: 1;
    }

    .panel-left h2 {
      font-family: 'Playfair Display', serif;
      color: #fff;
      font-size: 1.6rem;
      text-align: center;
      line-height: 1.3;
      position: relative; z-index: 1;
    }

    .panel-left p {
      color: rgba(255,255,255,.55);
      font-size: .88rem;
      text-align: center;
      line-height: 1.6;
      position: relative; z-index: 1;
    }

    /* right panel */
    .panel-right {
      flex: 1;
      background: var(--card-bg);
      padding: 44px 40px 36px;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .panel-right h1 {
      font-family: 'Playfair Display', serif;
      font-size: 2rem;
      color: var(--dark);
      margin-bottom: 6px;
    }

    .panel-right .subtitle {
      color: var(--muted);
      font-size: .88rem;
      margin-bottom: 28px;
    }

    /* form grid */
    .form-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px 20px;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    .form-group.full { grid-column: 1 / -1; }

    label {
      font-size: .8rem;
      font-weight: 500;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: .05em;
    }

    .input-wrap {
      position: relative;
    }

    .input-wrap > svg {
      position: absolute;
      left: 12px; top: 50%;
      transform: translateY(-50%);
      width: 16px; height: 16px;
      color: var(--muted);
      pointer-events: none;
    }

    input {
      width: 100%;
      background: var(--input-bg);
      border: 1.5px solid var(--border);
      border-radius: 10px;
      padding: 11px 12px 11px 38px;
      font-family: 'DM Sans', sans-serif;
      font-size: .92rem;
      color: var(--dark);
      transition: border-color .2s, box-shadow .2s;
      outline: none;
    }

    input:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(26,17,9,.08);
    }

    input.error { border-color: var(--error); }

    .field-error {
      font-size: .75rem;
      color: var(--error);
      display: none;
    }
    .field-error.visible { display: block; }

    /* password strength */
    .strength-bar {
      display: flex;
      gap: 4px;
      margin-top: 6px;
    }
    .strength-bar span {
      flex: 1; height: 4px;
      border-radius: 99px;
      background: var(--border);
      transition: background .3s;
    }
    .strength-label {
      font-size: .72rem;
      color: var(--muted);
      margin-top: 3px;
    }

    /* toggle password */
    .toggle-pw {
      position: absolute;
      right: 12px; top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      cursor: pointer;
      color: var(--muted);
      padding: 0;
      display: flex;
    }

    /* submit */
    .btn-submit {
      width: 100%;
      background: var(--accent);
      color: #fff;
      border: none;
      border-radius: 12px;
      padding: 14px;
      font-family: 'DM Sans', sans-serif;
      font-size: .95rem;
      font-weight: 600;
      letter-spacing: .06em;
      text-transform: uppercase;
      cursor: pointer;
      margin-top: 24px;
      transition: background .2s, transform .15s;
      position: relative;
      overflow: hidden;
    }

    .btn-submit:hover { background: #2d1e0f; }
    .btn-submit:active { transform: scale(.98); }

    .btn-submit .spinner {
      display: none;
      width: 18px; height: 18px;
      border: 2.5px solid rgba(255,255,255,.35);
      border-top-color: #fff;
      border-radius: 50%;
      animation: spin .7s linear infinite;
      position: absolute;
      left: 50%; top: 50%;
      transform: translate(-50%, -50%);
    }
    .btn-submit.loading .btn-text { opacity: 0; }
    .btn-submit.loading .spinner { display: block; }

    @keyframes spin { to { transform: translate(-50%,-50%) rotate(360deg); } }

    /* toast */
    .toast {
      display: none;
      padding: 12px 16px;
      border-radius: 10px;
      font-size: .86rem;
      margin-top: 14px;
      font-weight: 500;
    }
    .toast.error  { background: #fdecea; color: var(--error); display: block; }
    .toast.success{ background: #eafaf1; color: var(--success); display: block; }

    .footer-link {
      text-align: center;
      margin-top: 20px;
      font-size: .86rem;
      color: var(--muted);
    }
    .footer-link a {
      color: var(--dark);
      font-weight: 600;
      text-decoration: none;
    }
    .footer-link a:hover { text-decoration: underline; }

    /* responsive */
    @media (max-width: 680px) {
      .card { flex-direction: column; }
      .panel-left { flex: none; padding: 36px 24px; }
      .coffee-icon { width: 100px; height: 100px; }
      .panel-right { padding: 32px 24px 28px; }
      .form-grid { grid-template-columns: 1fr; }
      .form-group.full { grid-column: auto; }
    }
  </style>
</head>
<body>

<div class="card">

  <!-- Left decorative panel -->
  <div class="panel-left">
    <svg class="coffee-icon" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
      <!-- cup base -->
      <ellipse cx="100" cy="155" rx="55" ry="12" fill="#3d2b1f" opacity=".5"/>
      <!-- saucer -->
      <ellipse cx="100" cy="152" rx="62" ry="10" fill="#c8a87a"/>
      <!-- cup body -->
      <path d="M55 90 Q52 145 100 148 Q148 145 145 90 Z" fill="#f0dfc0"/>
      <!-- coffee surface -->
      <ellipse cx="100" cy="90" rx="45" ry="14" fill="#6f3e1a"/>
      <!-- latte heart -->
      <path d="M87 86 Q87 80 93 80 Q96 80 100 84 Q104 80 107 80 Q113 80 113 86 Q113 92 100 100 Q87 92 87 86Z" fill="#d4956a" opacity=".9"/>
      <!-- handle -->
      <path d="M145 100 Q172 100 172 120 Q172 140 145 138" stroke="#d4b896" stroke-width="8" fill="none" stroke-linecap="round"/>
      <!-- steam lines -->
      <path d="M80 72 Q76 62 80 52" stroke="rgba(255,255,255,.35)" stroke-width="3" fill="none" stroke-linecap="round"/>
      <path d="M100 68 Q96 58 100 48" stroke="rgba(255,255,255,.35)" stroke-width="3" fill="none" stroke-linecap="round"/>
      <path d="M120 72 Q116 62 120 52" stroke="rgba(255,255,255,.35)" stroke-width="3" fill="none" stroke-linecap="round"/>
    </svg>

    <h2>Join Cafe&nbsp;Nowa</h2>
    <p>Create your account and enjoy seamless ordering, loyalty rewards, and exclusive offers.</p>
  </div>

  <!-- Right form panel -->
  <div class="panel-right">
    <h1>Create Account</h1>
    <p class="subtitle">Fill in the details below to get started</p>

    <div id="toast" class="toast"></div>

    <form id="registerForm" novalidate>
      <div class="form-grid">

        <!-- Full Name -->
        <div class="form-group">
          <label for="full_name">Full Name</label>
          <div class="input-wrap">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
            <input type="text" id="full_name" name="full_name" placeholder="Juan Dela Cruz" autocomplete="name"/>
          </div>
          <span class="field-error" id="err-full_name">Please enter your full name.</span>
        </div>

        <!-- Username -->
        <div class="form-group">
          <label for="username">Username</label>
          <div class="input-wrap">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
            <input type="text" id="username" name="username" placeholder="juandelac" autocomplete="username"/>
          </div>
          <span class="field-error" id="err-username">Username must be 3–50 characters (letters, numbers, _).</span>
        </div>

        <!-- Email -->
        <div class="form-group full">
          <label for="email">Email Address</label>
          <div class="input-wrap">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
            <input type="email" id="email" name="email" placeholder="juan@email.com" autocomplete="email"/>
          </div>
          <span class="field-error" id="err-email">Please enter a valid email address.</span>
        </div>

        <!-- Phone -->
        <div class="form-group full">
          <label for="phone">Phone Number <span style="text-transform:none;font-size:.78rem;opacity:.7">(optional)</span></label>
          <div class="input-wrap">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07A19.5 19.5 0 0 1 4.69 12a19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 3.6 1h3a2 2 0 0 1 2 1.72c.127.96.361 1.903.7 2.81a2 2 0 0 1-.45 2.11L7.91 8.59a16 16 0 0 0 6.5 6.5l.95-.95a2 2 0 0 1 2.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0 1 22 16.92z"/></svg>
            <input type="tel" id="phone" name="phone" placeholder="09XXXXXXXXX" maxlength="11" autocomplete="tel"/>
          </div>
          <span class="field-error" id="err-phone">Please enter a valid phone number.</span>
        </div>

        <!-- Password -->
        <div class="form-group">
          <label for="password">Password</label>
          <div class="input-wrap">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
            <input type="password" id="password" name="password" placeholder="Min. 8 characters" autocomplete="new-password"/>
            <button type="button" class="toggle-pw" onclick="togglePw('password','eyeIcon1')" aria-label="Toggle password">
              <svg id="eyeIcon1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
            </button>
          </div>
          <div class="strength-bar">
            <span id="s1"></span><span id="s2"></span><span id="s3"></span><span id="s4"></span>
          </div>
          <div class="strength-label" id="strengthLabel"></div>
          <span class="field-error" id="err-password">Password must be at least 8 characters.</span>
        </div>

        <!-- Confirm Password -->
        <div class="form-group">
          <label for="confirm_password">Confirm Password</label>
          <div class="input-wrap">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
            <input type="password" id="confirm_password" name="confirm_password" placeholder="Re-enter password" autocomplete="new-password"/>
            <button type="button" class="toggle-pw" onclick="togglePw('confirm_password','eyeIcon2')" aria-label="Toggle confirm password">
              <svg id="eyeIcon2" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
            </button>
          </div>
          <span class="field-error" id="err-confirm_password">Passwords do not match.</span>
        </div>

      </div><!-- /form-grid -->

      <button type="submit" class="btn-submit" id="submitBtn">
        <span class="btn-text">Create Account</span>
        <span class="spinner"></span>
      </button>
    </form>

    <div class="footer-link">
      Already have an account? <a href="../login/login.html">Log in</a>
    </div>
  </div>

</div>

<script>
  /* Toggle password visibility */
  function togglePw(id, iconId) {
    const inp = document.getElementById(id);
    const isHidden = inp.type === 'password';
    inp.type = isHidden ? 'text' : 'password';
    const icon = document.getElementById(iconId);
    icon.innerHTML = isHidden
      ? `<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94"/><path d="M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19"/><line x1="1" y1="1" x2="23" y2="23"/>`
      : `<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/>`;
  }

  /* Password strength */
  const pwInput = document.getElementById('password');
  pwInput.addEventListener('input', () => {
    const v = pwInput.value;
    let score = 0;
    if (v.length >= 8)  score++;
    if (/[A-Z]/.test(v)) score++;
    if (/[0-9]/.test(v)) score++;
    if (/[^A-Za-z0-9]/.test(v)) score++;

    const colors = ['#e74c3c','#e67e22','#f1c40f','#27ae60'];
    const labels = ['Weak','Fair','Good','Strong'];
    for (let i = 1; i <= 4; i++) {
      const bar = document.getElementById('s'+i);
      bar.style.background = i <= score ? colors[score-1] : 'var(--border)';
    }
    document.getElementById('strengthLabel').textContent = score > 0 ? labels[score-1] : '';
  });

  /* Validate helpers */
  function showError(field, msg) {
    const inp = document.getElementById(field);
    const err = document.getElementById('err-'+field);
    inp.classList.add('error');
    if (msg) err.textContent = msg;
    err.classList.add('visible');
  }
  function clearError(field) {
    document.getElementById(field).classList.remove('error');
    document.getElementById('err-'+field).classList.remove('visible');
  }

  function showToast(msg, type) {
    const t = document.getElementById('toast');
    t.textContent = msg;
    t.className = 'toast ' + type;
  }

  /* Form submit */
  document.getElementById('registerForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    let valid = true;

    const fields = ['full_name','username','email','password','confirm_password'];
    fields.forEach(f => clearError(f));
    clearError('phone');

    const fullName = document.getElementById('full_name').value.trim();
    const username = document.getElementById('username').value.trim();
    const email    = document.getElementById('email').value.trim();
    const phone    = document.getElementById('phone').value.trim();
    const password = document.getElementById('password').value;
    const confirm  = document.getElementById('confirm_password').value;

    if (!fullName) { showError('full_name'); valid = false; }
    if (!username || !/^[a-zA-Z0-9_]{3,50}$/.test(username)) { showError('username'); valid = false; }
    if (!email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) { showError('email'); valid = false; }
    if (phone && !/^[0-9]{11}$/.test(phone)) { showError('phone','Phone number must be exactly 11 digits (e.g. 09XXXXXXXXX).'); valid = false; }
    if (password.length < 8) { showError('password'); valid = false; }
    if (password !== confirm) { showError('confirm_password'); valid = false; }

    if (!valid) return;

    const btn = document.getElementById('submitBtn');
    btn.classList.add('loading');
    btn.disabled = true;

    const formData = new FormData();
    formData.append('full_name', fullName);
    formData.append('username', username);
    formData.append('email', email);
    formData.append('phone', phone);
    formData.append('password', password);

    try {
      // Adjust the path to match your project structure
      const res = await fetch('../register/register_process.php', {
        method: 'POST',
        body: formData
      });

      const data = await res.json();

      if (data.success) {
        showToast('Account created successfully! Redirecting to login…', 'success');
        setTimeout(() => { window.location.href = '../login/login.html'; }, 2000);
      } else {
        showToast(data.message || 'Registration failed. Please try again.', 'error');
      }
    } catch (err) {
      showToast('Could not connect to the server. Please try again.', 'error');
    } finally {
      btn.classList.remove('loading');
      btn.disabled = false;
    }
  });
</script>
</body>
</html>